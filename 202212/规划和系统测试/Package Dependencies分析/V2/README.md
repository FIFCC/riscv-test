# OpenEuler软件包依赖调研

## 系统环境

- OpenEuler 22.03 V2 riscv64 preview
- RAM 12G
- vcpu 20

## 操作步骤

- 在终端中运行（用户无需运行）

```bash
sudo dnf install '*' --assumeno 2> output.old.txt
```

- 生成的output.old.txt后，将index.txt清空，将output.old.txt所涉及到的可能会出问题的软件包名称输入进去（此工作需本人完成）

- 在OpenEuler运行[该脚本](./script.sh)，*必须在root用户下*，初次运行两者均选y。

- 执行时截图：

![输入图片说明](img/Screenshot_20221212_224315.png)

- 得到该文件，[点击这里查看内容](./output.txt)

## 说明

- 此前本人采用

```bash
sudo dnf install -y '*' --setopts tsflags=test 2> output.txt
```

- 来得到报错信息，现将其更名为```output.old.txt```

- 分析[旧有输出文件](./output.old.txt)

- 我们发现，旧有错误信息中阐述了149个安装依赖与冲突的问题。

- 有一些软件包为冲突关系，例如```mysql-server-8.0.28-2.oe2203.riscv64```软件包与```mariadb-server-4:10.5.15-2.oe2203.riscv64```相冲突（因为两者提供相同的Linux可执行文件```mariadb-server```。

- 这种信息并非我们所需，所以我们需要对报错信息进行筛查。

- 而更多的则是软件包所需依赖在软件源中不存在，此即有效信息。

- 所以本人需要筛选若干软件包尝试进行安装，软件包名称放在[这里](./index.txt)，脚本通过读取该文件来自动尝试安装软件包从而发现并报告错误。

## 分析

- 发现出问题的软件包往往彼此关联，如```libreoffice```的众多语言包、```texlive```的若干插件、```vdsm```的一些钩子等等

- 依赖树顶端的软件包出问题时，整个依赖树都无法正常运转。如大量软件包依赖于```vdsm```，当它无法正常安装时，那些依赖它的软件包也会无法正常安装

- 部分软件包出现同名多版本共存的现象，导致包管理器无法选择哪一种进行安装

- 大多数依赖问题源于所依赖的软件包版本号不满足条件或无法提供相关功能，或在软件源中找不到所对应的依赖的软件包!